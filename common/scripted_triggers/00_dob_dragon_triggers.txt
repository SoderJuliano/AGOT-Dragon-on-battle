# ============================================================
# DRAGON ON BATTLE - Scripted Triggers
# Mod: Dragon on Battle (AGOT Addon) v0.1
# Nomes verificados contra AGOT 0.4.27
# ============================================================

# Verifica se o personagem é um dragonrider ATIVO com dragão vivo
# Usa o trigger oficial do AGOT: is_current_dragonrider
# Scope: character (o rider)
dob_is_dragonrider = {
	# is_current_dragonrider é o trigger oficial do AGOT (00_agot_dragon_triggers.txt)
	# Ele verifica: vivo, não incapaz, não preso, has_trait = dragonrider,
	# e que o dragão está relacionado via agot_dragon e está vivo
	is_current_dragonrider = yes
}

# Verifica se o rider tem um dragão adulto (size > 30) para batalha
# Scope: character (o rider)
# FIX: removido exists = var:current_dragon (redundante — var:current_dragon = { } já retorna false para ghost)
# is_current_dragonrider valida o bond via relação AGOT (não via var)
dob_has_adult_dragon = {
	is_current_dragonrider = yes
	var:current_dragon = {
		dragon_size > 30
	}
}

# Verifica se o rider ESTÁ usando o dragão em batalha (opção não desativada)
# Scope: character (o rider)
# FIX: removido exists = var:current_dragon (redundante)
# is_current_dragonrider_warfare já verifica: age >= 14 + is_current_dragonrider + NOT agot_not_using_dragon
dob_dragon_deployed_for_battle = {
	is_current_dragonrider_warfare = yes
	var:current_dragon = {
		dragon_size > 30
	}
}
